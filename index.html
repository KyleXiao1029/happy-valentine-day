<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æ”¿æ”¿ â¤ï¸ åŸ¹åŸ¹ - æˆ‘ä»¬çš„çˆ±</title>
    <!-- Vue 3 CDN -->
    <script src="vue.global.js"></script>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div id="app">
      <div class="loading-overlay" v-if="loadingProgress < 100">
        <div class="loading-content">
          <div class="loading-spinner"></div>
          <div class="loading-text">åŠ è½½æˆ‘ä»¬çš„ç”œèœœå›å¿†ä¸­...</div>
          <div class="loading-percentage">{{ loadingProgress }}%</div>
          <div class="loading-progress">
            <div class="progress-bar" :style="{ width: loadingProgress + '%' }"></div>
          </div>
          <div class="loading-count">{{ loadedImagesCount }} / {{ totalImagesCount }}</div>
        </div>
      </div>
      <nav>
        <div class="nav-content">
          <a href="#" class="logo">{{ coupleName }}</a>
          <span>ç›¸çˆ±äº {{ startDateStr }}</span>
        </div>
      </nav>

      <section class="hero">
        <h1>{{ hero.title }}</h1>
        <p>{{ hero.subtitle }}</p>
        <div class="typing-effect">{{ typingText }}</div>
        <button class="love-btn" @click="showSweetTalk">ğŸ’Œ é¢†å–ä»Šæ—¥ä»½çˆ±æ„</button>
        <div id="hearts-container"></div>
      </section>

      <section class="timer-section">
        <h2 class="section-title">æˆ‘ä»¬ç›¸çˆ±çš„æ—¶å…‰</h2>
        <div class="timer-grid">
          <div class="timer-item" v-for="(val, key) in timer" :key="key">
            <span class="timer-number">{{ val }}</span>
            <span class="timer-label">{{ timerLabels[key] }}</span>
          </div>
        </div>
      </section>

      <section class="timeline-section" ref="timelineRef">
        <h2 class="section-title">æˆ‘ä»¬çš„æ‹çˆ±é‡Œç¨‹ç¢‘</h2>
        <div class="timeline">
          <div class="timeline-item" v-for="(item, index) in timeline" :key="index" :class="{ visible: item.visible }">
            <div class="timeline-dot"></div>
            <div class="timeline-content">
              <span class="timeline-date">{{ item.date }}</span>
              <div class="timeline-images" v-if="item.images && item.images.length">
                <img
                  v-for="(img, imgIndex) in item.images"
                  :key="imgIndex"
                  :src="img"
                  class="timeline-img"
                  @click="openModal(img)"
                  alt="Memory"
                />
              </div>
              <h3>{{ item.title }}</h3>
              <p>{{ item.desc }}</p>
              <div class="timeline-action">
                <button class="heart-btn" :class="{ liked: item.liked }" @click="toggleLike(index)">
                  â¤ï¸ <span class="heart-count" v-if="item.liked">1</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="album-section">
        <h2 class="section-title">æˆ‘ä»¬çš„ç‹¬å®¶ç›¸å†Œ</h2>
        <div class="album-container" @click="swipeCard">
           <div class="polaroid-card" 
                v-for="(photo, index) in albumPhotos" 
                :key="photo.id"
                :style="{ 
                    zIndex: index, 
                    transform: photo.swiped ? 'translateX(100px) rotate(20deg)' : photo.transform 
                }"
                :class="{ swiped: photo.swiped }"
            >
              <img :src="photo.src" class="polaroid-img" />
              <div class="polaroid-caption">{{ photo.caption }}</div>
           </div>
        </div>
        <p class="album-hint">ğŸ‘† ç‚¹å‡»ç›¸ç‰‡ç¿»çœ‹æˆ‘ä»¬çš„å›å¿†</p>
      </section>

      <section class="about-section">
        <h2 class="section-title">æˆ‘çœ¼ä¸­çš„ä½ </h2>
        <div class="features-grid">
          <div class="feature-card" v-for="(feature, index) in features" :key="index">
            <span class="feature-icon">{{ feature.icon }}</span>
            <h3>{{ feature.title }}</h3>
            <p>{{ feature.desc }}</p>
          </div>
        </div>
      </section>

      <section class="gallery-section">
        <h2 class="section-title">ç‚¹æ»´å›å¿†</h2>
        
        <!-- Gallery Wrapper with Transition -->
        <div class="gallery-wrapper" :style="{ height: isSphereView ? '500px' : '420px' }">
          <transition name="fade" mode="out-in">
            <!-- Single View Mode (Mysterious Button) -->
            <div v-if="!isSphereView" class="mystery-box-container" @click="enterSphereView" key="single">
              <div class="mystery-box">
                <div class="box-front">ğŸ</div>
                <div class="box-back">âœ¨</div>
                <div class="box-inner">â¤ï¸</div>
              </div>
              <p class="gallery-hint">å‘ç°äº†ä¸€ä¸ªç¥ç§˜ç¤¼ç›’ï¼Œå¿«ç‚¹å‡»å¼€å¯æˆ‘ä»¬çš„å›å¿†å®‡å®™å§ï¼</p>
            </div>

            <!-- Sphere View Mode -->
            <div v-else key="sphere">
              <div
                :class="['sphere-container', { dragging: isDraggingSphere }]"
                @mousedown.prevent="startDrag"
                @touchstart.prevent="startDrag"
                @wheel.prevent="handleZoom"
              >
                <div class="sphere-scene" :style="sphereStyle">
                   <div 
                     class="sphere-item" 
                     v-for="(pos, index) in spherePositions" 
                     :key="index"
                     :style="{ transform: `translate3d(${pos.x}px, ${pos.y}px, ${pos.z}px) rotateY(${pos.rotY}deg) rotateX(${pos.rotX}deg)` }"
                     @click.stop="openModal(pos.src)"
                   >
                     <img :src="pos.src" class="sphere-img" />
                   </div>
                </div>
              </div>
              <div class="sphere-hint">
                 ğŸ‘† æ‹–åŠ¨æ—‹è½¬ Â· åŒæŒ‡ç¼©æ”¾ Â· ç‚¹å‡»æŸ¥çœ‹
              </div>
            </div>
          </transition>
        </div>
      </section>

      <section class="wishlist-section">
        <h2 class="section-title">æˆ‘ä»¬çš„æ„¿æœ›æ¸…å•</h2>
        <div class="wishlist-container">
          <div
            class="wishlist-item"
            v-for="(item, index) in wishlist"
            :key="index"
            :class="{ checked: item.done }"
            @click="toggleWish(index)"
          >
            <div class="checkbox"></div>
            <span class="wishlist-text">{{ item.text }}</span>
          </div>
        </div>
      </section>

      <section class="coupon-section">
        <h2 class="section-title">çˆ±æ„å…‘æ¢åˆ¸</h2>
        <div class="coupon-grid">
          <div 
            class="coupon-card" 
            v-for="(coupon, index) in coupons" 
            :key="index"
            :class="{ flipped: coupon.flipped }"
            @click="flipCoupon(index)"
          >
            <div class="coupon-inner">
              <div class="coupon-front">
                 <span>ğŸ’Œ ç‚¹æˆ‘æŠ½å–</span>
              </div>
              <div class="coupon-back">
                <div class="coupon-icon">{{ coupon.icon }}</div>
                <div>{{ coupon.text }}</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="quiz-section">
        <h2 class="section-title">é»˜å¥‘å°æµ‹è¯•</h2>
        <div class="quiz-card">
          <div class="quiz-question">{{ quiz.question }}</div>
          <div class="quiz-options">
            <div
              class="quiz-option"
              v-for="(opt, index) in quiz.options"
              :key="index"
              :class="{ 
                   correct: opt.selected && opt.correct, 
                   wrong: opt.selected && !opt.correct 
                 }"
              @click="checkAnswer(index)"
            >
              {{ opt.text }}
              <span v-if="opt.selected && opt.correct"> (ç­”å¯¹å•¦ï¼â¤ï¸)</span>
              <span v-if="opt.selected && !opt.correct"> (å†çŒœçŒœï¼Ÿ)</span>
            </div>
          </div>
        </div>
      </section>

      <section class="letter-section">
        <h2 class="section-title">è‡´æˆ‘æœ€çˆ±çš„å¥³å­©</h2>
        <div class="letter-card">
          <div class="letter-content">
            <p v-for="(para, index) in letter" :key="index">{{ para }}</p>
            <div class="signature">æ°¸è¿œçˆ±ä½ çš„<br />æ”¿æ”¿</div>
          </div>
        </div>
      </section>

      <section class="scanner-section">
        <h2 class="section-title" style="color: white; margin-bottom: 20px;">å¿ƒè·³æ„Ÿåº”</h2>
        <p style="color: #ddd;">é•¿æŒ‰ä¸‹æ–¹æŒ‡çº¹ï¼Œæ„Ÿåº”æˆ‘ä»¬çš„é»˜å¥‘</p>
        
        <div 
          class="scanner-container"
          @touchstart.prevent="startScan" 
          @touchend="endScan" 
          @mousedown="startScan" 
          @mouseup="endScan"
          @mouseleave="endScan"
        >
          <div class="scanner-btn" :class="{ scanning: isScanning }">
             <span v-if="!isScanning">ğŸ‘†</span>
             <span v-else>â¤ï¸</span>
          </div>
          <div class="scanner-ring"></div>
        </div>
        
        <div class="scanner-hint">{{ scanHint }}</div>
      </section>

      <div class="secret-message" v-if="secretUnlocked" @click.stop="secretUnlocked = false">
        <div class="secret-content">
          <h2>â¤ï¸ åŒ¹é…æˆåŠŸ â¤ï¸</h2>
          <p>æŒ‡çº¹åŒ¹é…åº¦ 100%</p>
          <p>ç¡®è®¤ä¸ºæˆ‘æœ€çˆ±çš„å¥³å­© â€”â€” åŸ¹åŸ¹</p>
          <p>â€œæ— è®ºä¸–ç•Œæ€ä¹ˆå˜ï¼Œæˆ‘çš„å¿ƒè·³æ°¸è¿œä¸ºä½ è€ŒåŠ¨ã€‚â€</p>
          <p style="font-size: 0.9rem; color: #aaa;">(ç‚¹å‡»ä»»æ„å¤„å…³é—­)</p>
        </div>
      </div>

      <footer>
        <p>Made with â¤ï¸ for Peipei</p>
        <p>&copy; 2026 æ”¿æ”¿</p>
      </footer>

      <!-- Image Modal -->
      <div class="modal" :class="{ active: modal.visible }" @click="closeModal">
        <span class="modal-close">&times;</span>
        <img class="modal-content" :src="modal.src" @click.stop />
      </div>

      <!-- Sweet Talk Modal -->
      <div class="sweet-modal" :class="{ active: sweetModal.visible }">
        <div class="sweet-card">
          <div class="sweet-text">{{ sweetModal.text }}</div>
          <button class="close-sweet-btn" @click="closeSweetTalk">æ”¶åˆ°äº† â¤ï¸</button>
        </div>
      </div>
    </div>

    <script src="script.js"></script>
  </body>
</html>